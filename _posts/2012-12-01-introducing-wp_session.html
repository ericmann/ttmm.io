---
layout: post
title: Introducing WP_Session
date: 2012-12-01 09:45:33.000000000 -08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Technology
tags:
- development
- Session Object
- WordPress
- WP_Session
meta:
  _yoast_wpseo_linkdex: '83'
  _edit_last: '2'
  _yoast_wpseo_focuskw: wp_session
  _yoast_wpseo_title: Introducing WP_Session
  _yoast_wpseo_metadesc: Last week I proposed the development of a WP_Session object.
    This weekend, I took the time to actually build it!
  _scribe_content_analysis: "O:8:\"stdClass\":7:{s:8:\"docScore\";s:2:\"56\";s:9:\"docScoreE\";a:2:{i:0;s:8:\"TitleLen\";i:1;s:5:\"NoPKW\";}s:11:\"fleschScore\";s:14:\"very
    difficult\";s:8:\"keywords\";a:7:{i:0;O:8:\"stdClass\":12:{s:3:\"kwc\";s:4:\"1.78\";s:3:\"kwd\";s:4:\"2.94\";s:3:\"kwe\";a:2:{i:0;s:4:\"KwET\";i:1;s:4:\"KwEM\";}s:3:\"kwf\";s:1:\"7\";s:3:\"kwl\";s:1:\"3\";s:7:\"kwlText\";s:11:\"Significant\";s:3:\"kwo\";s:1:\"B\";s:4:\"kwod\";s:91:\"To
    improve the ranking for this term, correct the copywriting and/or document issues
    found.\";s:3:\"kwp\";s:3:\"Low\";s:3:\"kwr\";s:1:\"1\";s:3:\"kws\";s:2:\"10\";s:4:\"text\";s:9:\"wordpress\";}i:1;O:8:\"stdClass\":12:{s:3:\"kwc\";s:4:\"1.19\";s:3:\"kwd\";s:4:\"0.42\";s:3:\"kwe\";a:2:{i:0;s:4:\"KwET\";i:1;s:5:\"KwELF\";}s:3:\"kwf\";s:1:\"1\";s:3:\"kwl\";s:1:\"4\";s:7:\"kwlText\";s:14:\"Not
    Emphasized\";s:3:\"kwo\";s:1:\"B\";s:4:\"kwod\";s:91:\"To improve the ranking
    for this term, correct the copywriting and/or document issues found.\";s:3:\"kwp\";s:8:\"Very
    Low\";s:3:\"kwr\";s:1:\"2\";s:3:\"kws\";s:4:\"5.06\";s:4:\"text\";s:15:\"the development\";}i:2;O:8:\"stdClass\":12:{s:3:\"kwc\";s:4:\"3.15\";s:3:\"kwd\";s:4:\"0.84\";s:3:\"kwe\";a:1:{i:0;s:4:\"KwEM\";}s:3:\"kwf\";s:1:\"2\";s:3:\"kwl\";s:1:\"2\";s:7:\"kwlText\";s:9:\"Important\";s:3:\"kwo\";s:1:\"C\";s:4:\"kwod\";s:139:\"While
    your copywriting is strong, consider writing more about this topic on your site
    and/or use this term more frequently in your content.\";s:3:\"kwp\";s:9:\"Very
    High\";s:3:\"kwr\";s:1:\"3\";s:3:\"kws\";s:1:\"0\";s:4:\"text\";s:11:\"introducing\";}i:3;O:8:\"stdClass\":12:{s:3:\"kwc\";s:4:\"0.78\";s:3:\"kwd\";s:4:\"0.84\";s:3:\"kwe\";a:2:{i:0;s:4:\"KwET\";i:1;s:4:\"KwEM\";}s:3:\"kwf\";s:1:\"2\";s:3:\"kwl\";s:1:\"4\";s:7:\"kwlText\";s:14:\"Not
    Emphasized\";s:3:\"kwo\";s:1:\"D\";s:4:\"kwod\";s:129:\"You will need to do some
    work for this term, including improving your copywriting and writing more about
    this topic on your site.\";s:3:\"kwp\";s:8:\"Very Low\";s:3:\"kwr\";s:1:\"7\";s:3:\"kws\";s:1:\"0\";s:4:\"text\";s:10:\"the
    object\";}i:4;O:8:\"stdClass\":12:{s:3:\"kwc\";s:4:\"1.19\";s:3:\"kwd\";s:4:\"0.84\";s:3:\"kwe\";a:1:{i:0;s:4:\"KwET\";}s:3:\"kwf\";s:1:\"2\";s:3:\"kwl\";s:1:\"4\";s:7:\"kwlText\";s:14:\"Not
    Emphasized\";s:3:\"kwo\";s:1:\"D\";s:4:\"kwod\";s:129:\"You will need to do some
    work for this term, including improving your copywriting and writing more about
    this topic on your site.\";s:3:\"kwp\";s:8:\"Very Low\";s:3:\"kwr\";s:1:\"4\";s:3:\"kws\";s:1:\"0\";s:4:\"text\";s:14:\"session
    object\";}i:5;O:8:\"stdClass\":12:{s:3:\"kwc\";s:4:\"1.19\";s:3:\"kwd\";s:4:\"0.42\";s:3:\"kwe\";a:2:{i:0;s:4:\"KwET\";i:1;s:5:\"KwELF\";}s:3:\"kwf\";s:1:\"1\";s:3:\"kwl\";s:1:\"4\";s:7:\"kwlText\";s:14:\"Not
    Emphasized\";s:3:\"kwo\";s:1:\"D\";s:4:\"kwod\";s:129:\"You will need to do some
    work for this term, including improving your copywriting and writing more about
    this topic on your site.\";s:3:\"kwp\";s:8:\"Very Low\";s:3:\"kwr\";s:1:\"5\";s:3:\"kws\";s:1:\"0\";s:4:\"text\";s:4:\"week\";}i:6;O:8:\"stdClass\":12:{s:3:\"kwc\";s:4:\"1.19\";s:3:\"kwd\";s:4:\"0.42\";s:3:\"kwe\";a:2:{i:0;s:4:\"KwET\";i:1;s:5:\"KwELF\";}s:3:\"kwf\";s:1:\"1\";s:3:\"kwl\";s:1:\"4\";s:7:\"kwlText\";s:14:\"Not
    Emphasized\";s:3:\"kwo\";s:1:\"D\";s:4:\"kwod\";s:129:\"You will need to do some
    work for this term, including improving your copywriting and writing more about
    this topic on your site.\";s:3:\"kwp\";s:8:\"Very Low\";s:3:\"kwr\";s:1:\"6\";s:3:\"kws\";s:1:\"0\";s:4:\"text\";s:7:\"weekend\";}}s:11:\"scribeScore\";s:2:\"41\";s:4:\"tags\";a:11:{i:0;s:9:\"wordpress\";i:1;s:15:\"the
    development\";i:2;s:11:\"introducing\";i:3;s:10:\"the object\";i:4;s:14:\"session
    object\";i:5;s:4:\"week\";i:6;s:7:\"weekend\";i:7;s:14:\"global objects\";i:8;s:11:\"development\";i:9;s:7:\"objects\";i:10;s:7:\"propose\";}s:7:\"request\";O:8:\"stdClass\":4:{s:10:\"html_title\";s:22:\"Introducing
    WP_Session\";s:11:\"description\";s:112:\"Last week I proposed the development
    of a WP_Session object. This weekend, I took the time to actually build it!\";s:7:\"content\";s:3622:\"<a
    title=\"WP_Session: A Proposal\" href=\"http://eamann.com/tech/wp_session-a-proposal/\">Last
    time</a>, I talked about what it would be like if WordPress supported sessions.
     Well, I decided to put my money where my mouth is and actually took the time
    to build it.\n\nI'm proud to announce the very first release of an implementation
    of [cci]WP_Session[/cci].<!--more-->\n\nThis new object implements PHP's [cci]ArrayAccess[/cci]
    behind the scenes, so it functions almost exactly like the standard [cci]$_SESSION[/cci]
    object.  Just make a global reference to the object, then treat it like an associative
    array:\n\n<code lang=\"php\" width=\"570px\">\nglobal $wp_session;\n\n// A string\n$wp_session['user_name']
    = 'User Name';\n\n// An array\n$wp_session['user_contact'] = array( 'email' =>
    'user@name.com' );\n\n// An object\n$wp_session['user_obj'] = new WP_User( 1 );\n</code>\n\nOn
    the back end, the object stores its data in WordPress transients - one transient
    per user - each with a unique ID provided by WordPress' [cci]PasswordHash[/cci]
    object to ensure uniqueness.  If you've got a caching plugin installed that uses
    memcached, then transients (like options) can be cached in memory, making the
    system very performant.\n\nOn the front end, your session token is stored in a
    cookie, called [cci]_wp_session[/cci].  WordPress will read this cookie, find
    your session, and populate the global object for you automatically.  At the end
    of its operation, WordPress will automatically write any changes to the session
    object back to the transient.\n\nSince we're aiming for as close to a 1:1 replacement
    for PHP's standard session object as possible, version 1.0 of the class comes
    withe several WordPress-flavored helper functions:\n<ul>\n\t<li>[cci]wp_session_cache_expire()[/cci]
    - get the session expiration time</li>\n\t<li>[cci]wp_session_commit()[/cci] -
    write session data out to the transient</li>\n\t<li>[cci]wp_session_decode()[/cci]
    - load data into the session from a serialized string</li>\n\t<li>[cci]wp_session_encode()[/cci]
    - write session data out to a serialized string</li>\n\t<li>[cci]wp_session_regenerate_id()[/cci]
    - change the ID of the current session to a new, random one</li>\n\t<li>[cci]wp_session_start()[/cci]
    - start the session and load data based on the user's cookie</li>\n\t<li>[cci]wp_session_status()[/cci]
    - check the status of the current session</li>\n\t<li>[cci]wp_session_unset()[/cci]
    - clear out all variables in the current session</li>\n\t<li>[cci]wp_session_write_close()[/cci]
    - write session data and end session.</li>\n</ul>\nTo make life easier, [cci]wp_session_start()[/cci]
    is wired to the [cci]plugins_loaded[/cci] action hook to make sure your session
    data is available as early as possible.  Also, [cci]wp_session_write_close()[/cci]
    is wired to [cci]shutdown[/cci] to persist any changes to session data after all
    other functions have finished running.\n\nIs is perfect? Probably not, but I'm
    comfortable enough with the class' functionality to say it's ready for <a href=\"http://ma.tt/2010/11/one-point-oh/\"
    title=\"1.0 is the Loneliest Number\">a 1.0 release</a>.  You can <a title=\"WP_Session
    1.0\" href=\"https://github.com/ericmann/wp-session-manager/archive/1.0.zip\">download
    the tagged ZIP</a> from GitHub, or you can <a title=\"WP_Session on GitHub\" href=\"https://github.com/ericmann/wp-session-manager\">fork
    the project to work on it yourself</a>.  If you have any recommendations, please
    submit a pull request so I can get them rolled in.\n\nRemember, my ultimate goal
    is to get this class to be a part of WordPress core (hopefully in version 3.6).
     So the more refinement we can get, the better!\";s:3:\"url\";s:18:\"http://eamann.com/\";}}"
  _wpas_done_all: '1'
  yourls_shorturl: http://eam.me/pz
  _zem_rp_image: empty
  _jetpack_related_posts_cache: a:1:{s:32:"8f6677c9d6b0f903e98ad32ec61f8deb";a:2:{s:7:"expires";i:1409901874;s:7:"payload";a:3:{i:0;a:1:{s:2:"id";i:5460;}i:1;a:1:{s:2:"id";i:5469;}i:2;a:1:{s:2:"id";i:5980;}}}}
  keen_postview_count_this_24_hours: '11'
  keen_postview_count_this_7_days: '93'
  keen_postview_count_this_30_days: '416'
  _wpghs_github_path: _posts/2012-12-01-introducing-wp_session.md
author:
  login: eamann
  email: eric@eamann.com
  display_name: Eric
  first_name: Eric
  last_name: Mann
permalink: "/tech/introducing-wp_session/"
---
<p><a title="WP_Session: A Proposal" href="http://eamann.com/tech/wp_session-a-proposal/">Last time</a>, I talked about what it would be like if WordPress supported sessions.  Well, I decided to put my money where my mouth is and actually took the time to build it.</p>
<p>I'm proud to announce the very first release of an implementation of [cci]WP_Session[/cci].<!--more--></p>
<p>This new object implements PHP's [cci]ArrayAccess[/cci] behind the scenes, so it functions almost exactly like the standard [cci]$_SESSION[/cci] object.  Just make a global reference to the object, then treat it like an associative array:</p>
<p><code lang="php" width="570px"><br />
global $wp_session;</p>
<p>// A string<br />
$wp_session['user_name'] = 'User Name';</p>
<p>// An array<br />
$wp_session['user_contact'] = array( 'email' => 'user@name.com' );</p>
<p>// An object<br />
$wp_session['user_obj'] = new WP_User( 1 );<br />
</code></p>
<p>On the back end, the object stores its data in WordPress transients - one transient per user - each with a unique ID provided by WordPress' [cci]PasswordHash[/cci] object to ensure uniqueness.  If you've got a caching plugin installed that uses memcached, then transients (like options) can be cached in memory, making the system very performant.</p>
<p>On the front end, your session token is stored in a cookie, called [cci]_wp_session[/cci].  WordPress will read this cookie, find your session, and populate the global object for you automatically.  At the end of its operation, WordPress will automatically write any changes to the session object back to the transient.</p>
<p>Since we're aiming for as close to a 1:1 replacement for PHP's standard session object as possible, version 1.0 of the class comes withe several WordPress-flavored helper functions:</p>
<ul>
<li>[cci]wp_session_cache_expire()[/cci] - get the session expiration time</li>
<li>[cci]wp_session_commit()[/cci] - write session data out to the transient</li>
<li>[cci]wp_session_decode()[/cci] - load data into the session from a serialized string</li>
<li>[cci]wp_session_encode()[/cci] - write session data out to a serialized string</li>
<li>[cci]wp_session_regenerate_id()[/cci] - change the ID of the current session to a new, random one</li>
<li>[cci]wp_session_start()[/cci] - start the session and load data based on the user's cookie</li>
<li>[cci]wp_session_status()[/cci] - check the status of the current session</li>
<li>[cci]wp_session_unset()[/cci] - clear out all variables in the current session</li>
<li>[cci]wp_session_write_close()[/cci] - write session data and end session.</li>
</ul>
<p>To make life easier, [cci]wp_session_start()[/cci] is wired to the [cci]plugins_loaded[/cci] action hook to make sure your session data is available as early as possible.  Also, [cci]wp_session_write_close()[/cci] is wired to [cci]shutdown[/cci] to persist any changes to session data after all other functions have finished running.</p>
<p>Is is perfect? Probably not, but I'm comfortable enough with the class' functionality to say it's ready for <a href="http://ma.tt/2010/11/one-point-oh/" title="1.0 is the Loneliest Number">a 1.0 release</a>.  You can <a title="WP_Session 1.0" href="https://github.com/ericmann/wp-session-manager/archive/1.0.zip">download the tagged ZIP</a> from GitHub, or you can <a title="WP_Session on GitHub" href="https://github.com/ericmann/wp-session-manager">fork the project to work on it yourself</a>.  If you have any recommendations, please submit a pull request so I can get them rolled in.</p>
<p>Remember, my ultimate goal is to get this class to be a part of WordPress core (hopefully in version 3.6).  So the more refinement we can get, the better!</p>
