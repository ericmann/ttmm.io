---
layout: post
title: Theme-ready Shortcodes in WordPress
date: 2012-10-05 08:00:28.000000000 -07:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- PHP
- Tutorials
tags:
- Markup
- plugin
- shortcode
- shortcodes
- Templates
- WordPress
meta:
  yourls_shorturl: http://eam.me/ic
  _wpcom_is_markdown: '1'
  _yoast_wpseo_metadesc: Make your WordPress shortcodes flexible by using a shortcode
    template for markup. Here's how to do it.
  _yoast_wpseo_title: Theme-ready Shortcodes in WordPress
  _edit_last: '2'
  _yoast_wpseo_focuskw: shortcode
  _scribe_content_analysis: O:8:"stdClass":7:{s:8:"docScore";s:3:"100";s:9:"docScoreE";a:0:{}s:11:"fleschScore";s:14:"very
    difficult";s:8:"keywords";a:10:{i:0;O:8:"stdClass":12:{s:3:"kwc";s:1:"5";s:3:"kwd";s:3:"2.1";s:3:"kwe";a:0:{}s:3:"kwf";s:1:"7";s:3:"kwl";s:1:"1";s:7:"kwlText";s:7:"Primary";s:3:"kwo";s:1:"A";s:4:"kwod";s:109:"Congratulations,
    this term strikes a good balance between search optimization and copywriting best
    practices.";s:3:"kwp";s:9:"Very High";s:3:"kwr";s:1:"1";s:3:"kws";s:2:"10";s:4:"text";s:9:"wordpress";}i:1;O:8:"stdClass":12:{s:3:"kwc";s:4:"4.63";s:3:"kwd";s:3:"2.4";s:3:"kwe";a:1:{i:0;s:4:"KwET";}s:3:"kwf";s:1:"8";s:3:"kwl";s:1:"1";s:7:"kwlText";s:7:"Primary";s:3:"kwo";s:1:"C";s:4:"kwod";s:139:"While
    your copywriting is strong, consider writing more about this topic on your site
    and/or use this term more frequently in your content.";s:3:"kwp";s:4:"High";s:3:"kwr";s:1:"4";s:3:"kws";s:1:"0";s:4:"text";s:6:"markup";}i:2;O:8:"stdClass":12:{s:3:"kwc";s:1:"5";s:3:"kwd";s:3:"1.5";s:3:"kwe";a:0:{}s:3:"kwf";s:1:"5";s:3:"kwl";s:1:"1";s:7:"kwlText";s:7:"Primary";s:3:"kwo";s:1:"C";s:4:"kwod";s:139:"While
    your copywriting is strong, consider writing more about this topic on your site
    and/or use this term more frequently in your content.";s:3:"kwp";s:9:"Very High";s:3:"kwr";s:1:"3";s:3:"kws";s:1:"0";s:4:"text";s:10:"shortcodes";}i:3;O:8:"stdClass":12:{s:3:"kwc";s:1:"5";s:3:"kwd";s:3:"1.8";s:3:"kwe";a:0:{}s:3:"kwf";s:1:"6";s:3:"kwl";s:1:"1";s:7:"kwlText";s:7:"Primary";s:3:"kwo";s:1:"C";s:4:"kwod";s:139:"While
    your copywriting is strong, consider writing more about this topic on your site
    and/or use this term more frequently in your content.";s:3:"kwp";s:4:"High";s:3:"kwr";s:1:"2";s:3:"kws";s:1:"0";s:4:"text";s:9:"shortcode";}i:4;O:8:"stdClass":12:{s:3:"kwc";s:4:"1.22";s:3:"kwd";s:3:"0.9";s:3:"kwe";a:2:{i:0;s:4:"KwET";i:1;s:4:"KwEM";}s:3:"kwf";s:1:"3";s:3:"kwl";s:1:"4";s:7:"kwlText";s:14:"Not
    Emphasized";s:3:"kwo";s:1:"D";s:4:"kwod";s:129:"You will need to do some work
    for this term, including improving your copywriting and writing more about this
    topic on your site.";s:3:"kwp";s:8:"Very Low";s:3:"kwr";s:1:"8";s:3:"kws";s:1:"0";s:4:"text";s:4:"html";}i:5;O:8:"stdClass":12:{s:3:"kwc";s:4:"1.22";s:3:"kwd";s:3:"0.3";s:3:"kwe";a:3:{i:0;s:4:"KwET";i:1;s:4:"KwEM";i:2;s:5:"KwELF";}s:3:"kwf";s:1:"1";s:3:"kwl";s:1:"4";s:7:"kwlText";s:14:"Not
    Emphasized";s:3:"kwo";s:1:"D";s:4:"kwod";s:129:"You will need to do some work
    for this term, including improving your copywriting and writing more about this
    topic on your site.";s:3:"kwp";s:8:"Very Low";s:3:"kwr";s:1:"5";s:3:"kws";s:4:"1.94";s:4:"text";s:12:"theme
    system";}i:6;O:8:"stdClass":12:{s:3:"kwc";s:4:"1.22";s:3:"kwd";s:3:"0.9";s:3:"kwe";a:2:{i:0;s:4:"KwET";i:1;s:4:"KwEM";}s:3:"kwf";s:1:"3";s:3:"kwl";s:1:"4";s:7:"kwlText";s:14:"Not
    Emphasized";s:3:"kwo";s:1:"D";s:4:"kwod";s:129:"You will need to do some work
    for this term, including improving your copywriting and writing more about this
    topic on your site.";s:3:"kwp";s:8:"Very Low";s:3:"kwr";s:1:"7";s:3:"kws";s:1:"0";s:4:"text";s:9:"templates";}i:7;O:8:"stdClass":12:{s:3:"kwc";s:4:"1.63";s:3:"kwd";s:3:"0.3";s:3:"kwe";a:2:{i:0;s:4:"KwET";i:1;s:5:"KwELF";}s:3:"kwf";s:1:"1";s:3:"kwl";s:1:"4";s:7:"kwlText";s:14:"Not
    Emphasized";s:3:"kwo";s:1:"D";s:4:"kwod";s:129:"You will need to do some work
    for this term, including improving your copywriting and writing more about this
    topic on your site.";s:3:"kwp";s:8:"Very Low";s:3:"kwr";s:1:"6";s:3:"kws";s:1:"0";s:4:"text";s:14:"your
    wordpress";}i:8;O:8:"stdClass":12:{s:3:"kwc";s:4:"1.22";s:3:"kwd";s:3:"0.3";s:3:"kwe";a:3:{i:0;s:4:"KwET";i:1;s:4:"KwEM";i:2;s:5:"KwELF";}s:3:"kwf";s:1:"1";s:3:"kwl";s:1:"4";s:7:"kwlText";s:14:"Not
    Emphasized";s:3:"kwo";s:1:"D";s:4:"kwod";s:129:"You will need to do some work
    for this term, including improving your copywriting and writing more about this
    topic on your site.";s:3:"kwp";s:8:"Very Low";s:3:"kwr";s:1:"9";s:3:"kws";s:1:"0";s:4:"text";s:6:"themes";}i:9;O:8:"stdClass":12:{s:3:"kwc";s:4:"1.22";s:3:"kwd";s:3:"0.6";s:3:"kwe";a:3:{i:0;s:4:"KwET";i:1;s:4:"KwEM";i:2;s:5:"KwELF";}s:3:"kwf";s:1:"2";s:3:"kwl";s:1:"4";s:7:"kwlText";s:14:"Not
    Emphasized";s:3:"kwo";s:1:"D";s:4:"kwod";s:129:"You will need to do some work
    for this term, including improving your copywriting and writing more about this
    topic on your site.";s:3:"kwp";s:8:"Very Low";s:3:"kwr";s:2:"10";s:3:"kws";s:1:"0";s:4:"text";s:14:"template
    files";}}s:11:"scribeScore";s:2:"57";s:4:"tags";a:17:{i:0;s:9:"wordpress";i:1;s:6:"markup";i:2;s:10:"shortcodes";i:3;s:9:"shortcode";i:4;s:4:"html";i:5;s:12:"theme
    system";i:6;s:9:"templates";i:7;s:14:"your wordpress";i:8;s:6:"themes";i:9;s:14:"template
    files";i:10;s:24:"php programming language";i:11;s:14:"microsoft word";i:12;s:15:"using
    templates";i:13;s:16:"markup languages";i:14;s:13:"blog software";i:15;s:23:"technical
    communication";i:16;s:4:"form";}s:7:"request";O:8:"stdClass":4:{s:10:"html_title";s:35:"Theme-ready
    Shortcodes in WordPress";s:11:"description";s:102:"Make your WordPress shortcodes
    flexible by using a shortcode template for markup. Here's how to do it.";s:7:"content";s:5496:"<p>A
    few months back, I taught you how to <a title="Theme-ready Widgets in WordPress"
    href="https://jumping-duck.com/tutorial/theme-ready-widgets-in-wordpress/">make
    your widgets theme-ready</a> by extracting the actual markup into an overridable
    template.  Now, we're going to do the same for shortcodes.</p><p>And for those
    of you wanting to see this in practice, stay tuned for the release of version
    2.5 of <a title="WP Publication Archive" href="https://jumping-duck.com/wordpress/plugins/wp-publication-archive/">WP
    Publication Archive</a> in a few weeks.  I'm using this technique to make markup
    easy to change.<!--more--></p><h2>Why Use Templates?</h2><p>The beauty of WordPress
    is its flexibility.  With a limited amount of technical know-how, you can build
    a website in minutes that looks completely different from anything else built
    on the same platform.  It can be as unique as you want and as customized to you
    as can be.</p><p>This flexibility is extended through WordPress' theme system.
     If you have a WordPress site, you've used a theme.  What you might now know about
    the theme, though, is it's just a template.</p><p>WordPress populates a few code
    objects based on the queried page (whatever link you followed to get to the site),
    then hands those objects off to the loaded template to render things to the page.
     It's flexible, because WordPress doesn't know (or need to know) anything about
    the template.  You can render your content as HTML, XML, <a title="JSON Api" href="http://wordpress.org/extend/plugins/json-api/">JSON</a>,
    or whatever other capitalized acronym you want.</p><p>We're going to use a template
    for our shortcode for the very same reason - our plugin will provide a <em>default</em>
    display for the content, but really that can be replaced by any other template
    the end user chooses.</p><h2>Populating the Data</h2><p>It doesn't really matter <em>how</em>
    you build your data so long as you're precise in the way your data is constructed
    and used.  The new version of WP Publication Archive, for example, globalizes
    a variable and populates it with an array.  This array contains, among other things,
    a collection of publications that need to be displayed whenever the user enters
    the [cci][wp-publication-archive][/cci] shortcode.</p><p>The variable has to be
    global in scope so that the template can access it.  Be <em>very precise</em>
    with your global object name so no other plugins step all over it.  It might also
    be a good idea to pass the object through a filter before loading the template
    as well to provide the highest level of flexibility possible:</p><p>... global
    object</p><h2>Loading the Template</h2><p>Now we actually load of the template.
     Be sure to set an easy-to-remember name - I typically prefix my template files
    with [cci]template.[/cci] so I can remember which files in the plugin might be
    overridden by a theme.  A descriptive name will also help users know what the
    file is for:</p><p>... template loader</p><p>The idea behind this code is to check
    first if the theme has a similarly-named file.  If so, load that one up.  This
    file is placed either by the theme developer or the end user <em>specifically
    to work with your plugin</em>.  Make sure you respect that and defer to their
    markup.  If the file doesn't exist, though, load some kind of fallback from within
    the plugin.</p><p>This fallback file should serve as an example to other developers
    how <em>you</em> think content should appear, but it is not a strict expectation.
     Consider it more of an example for how to build a shortcode template.</p><h3>Output
    Buffer</h3><p>Notice in this example I'm using an output buffer.  Normally, I
    wouldn't encourage that.  Shortcodes, thought, <em>return</em> data rather than
    output the data.  But template files should always be geared towards presentation.</p><p>It's
    easiest to write the template file as if it's an output file.  Use raw HTML and
    php's [cci]echo[/cci] to generate things.  This way it stays in-line with the
    widget templates we've done before and with themes (as templates) as well.</p><h2>Building
    Markup</h2><p>The shortcode template should have no functionality or logic.  Zero.
    None.</p><p>The template file is 100% markup.  You might throw in a loop or two
    to iterate through collections, but there should be no queries or other data fetching
    in the file.  Everything you're looping through should be provided in the global
    object you passed in earlier.</p><p>The end user might elect to add their own
    additional logic (third party plugins might add meta to your plugin), and they
    can definitely do that.  But you, as the initial developer, should not.  Keep
    it simple.</p><p>... markup</p><h2>What's Next?</h2><p>From here, any developer
    can drop a [cci]template.wppa_publication_list.php[/cci] file into their theme
    and replace my default markup with whatever custom markup they choose.  They can
    use only HTML tags ([cci]&lt;aside&gt;[/cci], [cci]&lt;section&gt;[/cci], and
    the like), they can write out XML, they can reposition elements, etc.  It's entirely
    up to them.</p><p>But the end user only ever has to enter one shortcode.  Like
    I said, simple.</p><p>Other plugin developers can also hook into the template
    loading process and inject some custom template as well.  Perhaps another plugin
    is built to specifically extend WP Publication Archive to add additional meta
    information and markup - they can hook in and add their own template instead.</p>";s:3:"url";s:25:"https://jumping-duck.com/";}}
  _yoast_wpseo_linkdex: '68'
  _genesis_scripts_body_position: bottom
  _yoast_wpseo_primary_category: ''
  _wpas_skip_1588757: '1'
  _wpas_skip_1588752: '1'
  _wpas_skip_1650274: '1'
  _yoast_wpseo_focuskw_text_input: shortcode
  _yoast_wpseo_content_score: '90'
  _wpghs_github_path: _posts/2012-10-05-theme-ready-shortcodes-in-wordpress.md
author:
  login: eamann
  email: eric@eamann.com
  display_name: Eric
  first_name: Eric
  last_name: Mann
permalink: "/php/theme-ready-shortcodes-in-wordpress/"
---
<p>A few months back, I taught you how to <a title="Theme-ready Widgets in WordPress" href="https://ttmm.io/tutorial/theme-ready-widgets-in-wordpress/">make your widgets theme-ready</a> by extracting the actual markup into an overridable template.  Now, we're going to do the same for shortcodes.</p>
<p>And for those of you wanting to see this in practice, stay tuned for the release of version 2.5 of WP Publication Archive in a few weeks.  I'm using this technique to make markup easy to change.<!--more--></p>
<h2>Why Use Templates?</h2>
<p>The beauty of WordPress is its flexibility.  With a limited amount of technical know-how, you can build a website in minutes that looks completely different from anything else built on the same platform.  It can be as unique as you want and as customized to you as can be.</p>
<p>This flexibility is extended through WordPress' theme system.  If you have a WordPress site, you've used a theme.  What you might now know about the theme, though, is it's just a template.</p>
<p>WordPress populates a few code objects based on the queried page (whatever link you followed to get to the site), then hands those objects off to the loaded template to render things to the page.  It's flexible, because WordPress doesn't know (or need to know) anything about the template.  You can render your content as HTML, XML, <a title="JSON Api" href="http://wordpress.org/extend/plugins/json-api/">JSON</a>, or whatever other capitalized acronym you want.</p>
<p>We're going to use a template for our shortcode for the very same reason - our plugin will provide a <em>default</em> display for the content, but really that can be replaced by any other template the end user chooses.</p>
<h2>Populating the Data</h2>
<p>It doesn't really matter <em>how</em> you build your data so long as you're precise in the way your data is constructed and used.  The new version of WP Publication Archive, for example, globalizes a variable and populates it with an array.  This array contains, among other things, a collection of publications that need to be displayed whenever the user enters the [cci][wp-publication-archive][/cci] shortcode.</p>
<p>The variable has to be global in scope so that the template can access it.  Be <em>very precise</em> with your global object name so no other plugins step all over it.  It might also be a good idea to pass the object through a filter before loading the template as well to provide the highest level of flexibility possible:</p>
<p><code lang="php"><br />
// Get a global container variable and populate it with our data<br />
global $wppa_container;<br />
$wppa_container = array(<br />
    'publications' => $publications,<br />
    'total_pubs'   => $total_pubs,<br />
    'limit'        => $limit,<br />
    'offset'       => $offset,<br />
    'paged'        => $paged,<br />
    'post'         => $post<br />
);<br />
$wppa_container = apply_filters( 'wppa_publication_list_container', $wppa_container );<br />
</code></p>
<h2>Loading the Template</h2>
<p>Now we actually load of the template.  Be sure to set an easy-to-remember name - I typically prefix my template files with [cci]template.[/cci] so I can remember which files in the plugin might be overridden by a theme.  A descriptive name will also help users know what the file is for:</p>
<p><code lang="php"><br />
// Get the publication list template<br />
$template_name = apply_filters( 'wppa_list_template', 'template.wppa_publication_list.php' );<br />
$path = locate_template( $template_name );<br />
if ( empty( $path ) ) {<br />
    $path = WP_PUB_ARCH_DIR . 'includes/' . $template_name;<br />
}</p>
<p>// Start a buffer to capture the HTML output of the shortcode.<br />
ob_start();</p>
<p>include( $path );</p>
<p>$output = ob_get_contents();</p>
<p>ob_end_clean();</p>
<p>// Because globals are evil, clean up afterwards.<br />
unset( $wppa_container );</p>
<p>return $output;<br />
</code></p>
<p>The idea behind this code is to check first if the theme has a similarly-named file.  If so, load that one up.  This file is placed either by the theme developer or the end user <em>specifically to work with your plugin</em>.  Make sure you respect that and defer to their markup.  If the file doesn't exist, though, load some kind of fallback from within the plugin.</p>
<p>This fallback file should serve as an example to other developers how <em>you</em> think content should appear, but it is not a strict expectation.  Consider it more of an example for how to build a shortcode template.</p>
<h3>Output Buffer</h3>
<p>Notice in this example I'm using an output buffer.  Normally, I wouldn't encourage that.  Shortcodes, thought, <em>return</em> data rather than output the data.  But template files should always be geared towards presentation.</p>
<p>It's easiest to write the template file as if it's an output file.  Use raw HTML and php's [cci]echo[/cci] to generate things.  This way it stays in-line with the widget templates we've done before and with themes (as templates) as well.</p>
<h2>Building Markup</h2>
<p>The shortcode template should have no functionality or logic.  Zero. None.</p>
<p>The template file is 100% markup.  You might throw in a loop or two to iterate through collections, but there should be no queries or other data fetching in the file.  Everything you're looping through should be provided in the global object you passed in earlier.</p>
<p>The end user might elect to add their own additional logic (third party plugins might add meta to your plugin), and they can definitely do that.  But you, as the initial developer, should not.  Keep it simple.</p>
<p><code lang="php"><br />
<?php global $wppa_container;<br />
extract( $wppa_container );<br />
?></p>
<div class="publication-archive">
<?php foreach( $publications as $publication ) { ?><br />
    <?php $pub = new WP_Publication_Archive_Item( $publication?>ID, $publication->post_title, $publication->post_date ); ?></p>
<div class="single-publication">
        <?php $pub?>the_thumbnail(); ?><br />
        <?php $pub?>the_title(); ?><br />
        <?php $pub?>the_authors(); ?><br />
        <?php $pub?>the_uri(); ?><br />
        <?php $pub?>the_summary(); ?><br />
        <?php $pub?>the_keywords(); ?><br />
        <?php $pub?>the_categories(); ?>
    </div>
<p><?php } ?>
</div>
<p></code></p>
<h2>What's Next?</h2>
<p>From here, any developer can drop a [cci]template.wppa_publication_list.php[/cci] file into their theme and replace my default markup with whatever custom markup they choose.  They can use only HTML tags ([cci]</p>
<p>&lt;</p>
<p>aside>[/cci], [cci]</p>
<p>&lt;</p>
<p>section>[/cci], and the like), they can write out XML, they can reposition elements, etc.  It's entirely up to them.</p>
<p>But the end user only ever has to enter one shortcode.  Like I said, simple.</p>
<p>Other plugin developers can also hook into the template loading process and inject some custom template as well.  Perhaps another plugin is built to specifically extend WP Publication Archive to add additional meta information and markup - they can hook in and add their own template instead.</p>
