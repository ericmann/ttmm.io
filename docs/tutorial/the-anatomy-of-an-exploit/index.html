<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
        <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>The Anatomy of an Exploit | Things that Matter Most</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="The Anatomy of an Exploit" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I&#39;m a huge fan of security. I spend many a weekend experimenting with new encryption techniques, hash algorithms, and security protocols. As a result, I also come across several different server exploits in the wild. PHP hacks, [cci].htaccess[/cci] hacks, JavaScript injection, etc. I once even saw a server hacked through a corrupt PNG image that installed a PHP console when it was loaded. To a new developer, is is all pretty scary stuff. Here&#39;s an example of an exploit I came across last week - and how to both prevent and recover from it. The Exploit A friend alerted the world via Twitter to an odd issue posted in the WordPress forums.  A specific site was being redirected to a Russian website, but only if you visited with a mobile device. I loaded the website both on my desktop and Android phone to see the difference - sure enough, the page loaded fine on the PC and the phone got Russian spam. Next, I turned to Fiddler to see what else I could diagnose. With a desktop user agent, everything came across the wire just fine.  Substituting a mobile user agent string - or any string containing the words &quot;Android&quot; or &quot;iPhone&quot; yielded somewhat different results: There is now a coded block of JavaScript injected above the opening [cci]&lt;!DOCTYPE html SYSTEM&gt;[/cci] tag.  When decoded, this script writes a new script tag to the browser.  This script tag loads a remote URL that forces a redirect from the site you&#39;re on to a site of the hacker&#39;s choosing. I followed up with my results in the forums, and mentioned them on Twitter.  That&#39;s when Sucuri Security joined the conversation and confirmed this is a known malware bug. https://twitter.com/sucuri_security/status/227884824885608451 How To Fix It Most known bugs also have known fixes - in this case, the exploit was a poorly secured [cci].htaccess[/cci] file that loads the extra script based on the user agent passed in the request.  Flushing the file is usually enough to remove it. But that&#39;s never enough for me. Once an attacker has access to your system, they&#39;ll likely install more than one back door.  Yes, [cci].htaccess[/cci] is obviously corrupt.  But there might be code lurking in a random PHP or JavaScript file on the server, just waiting to re-infect your site. The best way to recover a WordPress site is to: Change your FTP password (this might be the hacker&#39;s original way in) Change your MySQL password (keep your database secure - also change this in [cci]wp-config.php[/cci]) Check your [cci]wp-config.php[/cci] file line by line to make sure it&#39;s clean. Compare it to the [cci]wp-config-sample.php[/cci] file from a fresh download of WordPress to be sure. Reinstall WordPress. This means deleting everythingexcept for your configuration file, themes, and plugins Ideally, you&#39;ll also remove all themes and plugins and reinstall them from clean sources as well. If you can&#39;t, make sure you go through each line of every PHP file and make sure there isn&#39;t anything hinky going on there.[ref]Yes, I did just use the word hinky in a professional post. Get over it. :-)[/ref] Go through your entire [cci]/uploads[/cci] directoy and make sure no rogue files or scripts are lying around Restore your database from the most recent (clean) backup If you don&#39;t have a backup, get ready for a long night of going through data tables manually to be sure there isn&#39;t anything hiding in the database And really, why don&#39;t you have an automated backup? Set one up now while you&#39;re at it! Ask another developer to double check your work to be sure you haven&#39;t missed anything. In a pinch, you can also hire the experts at Sucuri to clean things up for you. They know what they&#39;re doing and have likely cleaned up this specific hack already. Don&#39;t Get Hacked in the First Place There&#39;s quite a bit you can do to harden your site before it gets hacked. Here are just a few quick recommendations: Change your WordPress admin password regularly. And don&#39;t use the same password anywhere else. Use different passwords and logins for WordPress admin, FTP, and MySQL. If you&#39;re running your own VPS, don&#39;t do anything as root. If you can, turn off FTP altogether. If you absolutely need it, consider SFTP instead. Check your system access logs for weirdness regularly. Make routine backups of your filesystem and database so you can recover quickly from problems. Consider signing up with a malware monitoring service - Sucuri happens to offer this, too." />
<meta property="og:description" content="I&#39;m a huge fan of security. I spend many a weekend experimenting with new encryption techniques, hash algorithms, and security protocols. As a result, I also come across several different server exploits in the wild. PHP hacks, [cci].htaccess[/cci] hacks, JavaScript injection, etc. I once even saw a server hacked through a corrupt PNG image that installed a PHP console when it was loaded. To a new developer, is is all pretty scary stuff. Here&#39;s an example of an exploit I came across last week - and how to both prevent and recover from it. The Exploit A friend alerted the world via Twitter to an odd issue posted in the WordPress forums.  A specific site was being redirected to a Russian website, but only if you visited with a mobile device. I loaded the website both on my desktop and Android phone to see the difference - sure enough, the page loaded fine on the PC and the phone got Russian spam. Next, I turned to Fiddler to see what else I could diagnose. With a desktop user agent, everything came across the wire just fine.  Substituting a mobile user agent string - or any string containing the words &quot;Android&quot; or &quot;iPhone&quot; yielded somewhat different results: There is now a coded block of JavaScript injected above the opening [cci]&lt;!DOCTYPE html SYSTEM&gt;[/cci] tag.  When decoded, this script writes a new script tag to the browser.  This script tag loads a remote URL that forces a redirect from the site you&#39;re on to a site of the hacker&#39;s choosing. I followed up with my results in the forums, and mentioned them on Twitter.  That&#39;s when Sucuri Security joined the conversation and confirmed this is a known malware bug. https://twitter.com/sucuri_security/status/227884824885608451 How To Fix It Most known bugs also have known fixes - in this case, the exploit was a poorly secured [cci].htaccess[/cci] file that loads the extra script based on the user agent passed in the request.  Flushing the file is usually enough to remove it. But that&#39;s never enough for me. Once an attacker has access to your system, they&#39;ll likely install more than one back door.  Yes, [cci].htaccess[/cci] is obviously corrupt.  But there might be code lurking in a random PHP or JavaScript file on the server, just waiting to re-infect your site. The best way to recover a WordPress site is to: Change your FTP password (this might be the hacker&#39;s original way in) Change your MySQL password (keep your database secure - also change this in [cci]wp-config.php[/cci]) Check your [cci]wp-config.php[/cci] file line by line to make sure it&#39;s clean. Compare it to the [cci]wp-config-sample.php[/cci] file from a fresh download of WordPress to be sure. Reinstall WordPress. This means deleting everythingexcept for your configuration file, themes, and plugins Ideally, you&#39;ll also remove all themes and plugins and reinstall them from clean sources as well. If you can&#39;t, make sure you go through each line of every PHP file and make sure there isn&#39;t anything hinky going on there.[ref]Yes, I did just use the word hinky in a professional post. Get over it. :-)[/ref] Go through your entire [cci]/uploads[/cci] directoy and make sure no rogue files or scripts are lying around Restore your database from the most recent (clean) backup If you don&#39;t have a backup, get ready for a long night of going through data tables manually to be sure there isn&#39;t anything hiding in the database And really, why don&#39;t you have an automated backup? Set one up now while you&#39;re at it! Ask another developer to double check your work to be sure you haven&#39;t missed anything. In a pinch, you can also hire the experts at Sucuri to clean things up for you. They know what they&#39;re doing and have likely cleaned up this specific hack already. Don&#39;t Get Hacked in the First Place There&#39;s quite a bit you can do to harden your site before it gets hacked. Here are just a few quick recommendations: Change your WordPress admin password regularly. And don&#39;t use the same password anywhere else. Use different passwords and logins for WordPress admin, FTP, and MySQL. If you&#39;re running your own VPS, don&#39;t do anything as root. If you can, turn off FTP altogether. If you absolutely need it, consider SFTP instead. Check your system access logs for weirdness regularly. Make routine backups of your filesystem and database so you can recover quickly from problems. Consider signing up with a malware monitoring service - Sucuri happens to offer this, too." />
<meta property="og:site_name" content="Things that Matter Most" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2012-07-31T09:00:45-07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="The Anatomy of an Exploit" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"The Anatomy of an Exploit","dateModified":"2012-07-31T09:00:45-07:00","datePublished":"2012-07-31T09:00:45-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"/tutorial/the-anatomy-of-an-exploit/"},"url":"/tutorial/the-anatomy-of-an-exploit/","description":"I&#39;m a huge fan of security. I spend many a weekend experimenting with new encryption techniques, hash algorithms, and security protocols. As a result, I also come across several different server exploits in the wild. PHP hacks, [cci].htaccess[/cci] hacks, JavaScript injection, etc. I once even saw a server hacked through a corrupt PNG image that installed a PHP console when it was loaded. To a new developer, is is all pretty scary stuff. Here&#39;s an example of an exploit I came across last week - and how to both prevent and recover from it. The Exploit A friend alerted the world via Twitter to an odd issue posted in the WordPress forums.  A specific site was being redirected to a Russian website, but only if you visited with a mobile device. I loaded the website both on my desktop and Android phone to see the difference - sure enough, the page loaded fine on the PC and the phone got Russian spam. Next, I turned to Fiddler to see what else I could diagnose. With a desktop user agent, everything came across the wire just fine.  Substituting a mobile user agent string - or any string containing the words &quot;Android&quot; or &quot;iPhone&quot; yielded somewhat different results: There is now a coded block of JavaScript injected above the opening [cci]&lt;!DOCTYPE html SYSTEM&gt;[/cci] tag.  When decoded, this script writes a new script tag to the browser.  This script tag loads a remote URL that forces a redirect from the site you&#39;re on to a site of the hacker&#39;s choosing. I followed up with my results in the forums, and mentioned them on Twitter.  That&#39;s when Sucuri Security joined the conversation and confirmed this is a known malware bug. https://twitter.com/sucuri_security/status/227884824885608451 How To Fix It Most known bugs also have known fixes - in this case, the exploit was a poorly secured [cci].htaccess[/cci] file that loads the extra script based on the user agent passed in the request.  Flushing the file is usually enough to remove it. But that&#39;s never enough for me. Once an attacker has access to your system, they&#39;ll likely install more than one back door.  Yes, [cci].htaccess[/cci] is obviously corrupt.  But there might be code lurking in a random PHP or JavaScript file on the server, just waiting to re-infect your site. The best way to recover a WordPress site is to: Change your FTP password (this might be the hacker&#39;s original way in) Change your MySQL password (keep your database secure - also change this in [cci]wp-config.php[/cci]) Check your [cci]wp-config.php[/cci] file line by line to make sure it&#39;s clean. Compare it to the [cci]wp-config-sample.php[/cci] file from a fresh download of WordPress to be sure. Reinstall WordPress. This means deleting everythingexcept for your configuration file, themes, and plugins Ideally, you&#39;ll also remove all themes and plugins and reinstall them from clean sources as well. If you can&#39;t, make sure you go through each line of every PHP file and make sure there isn&#39;t anything hinky going on there.[ref]Yes, I did just use the word hinky in a professional post. Get over it. :-)[/ref] Go through your entire [cci]/uploads[/cci] directoy and make sure no rogue files or scripts are lying around Restore your database from the most recent (clean) backup If you don&#39;t have a backup, get ready for a long night of going through data tables manually to be sure there isn&#39;t anything hiding in the database And really, why don&#39;t you have an automated backup? Set one up now while you&#39;re at it! Ask another developer to double check your work to be sure you haven&#39;t missed anything. In a pinch, you can also hire the experts at Sucuri to clean things up for you. They know what they&#39;re doing and have likely cleaned up this specific hack already. Don&#39;t Get Hacked in the First Place There&#39;s quite a bit you can do to harden your site before it gets hacked. Here are just a few quick recommendations: Change your WordPress admin password regularly. And don&#39;t use the same password anywhere else. Use different passwords and logins for WordPress admin, FTP, and MySQL. If you&#39;re running your own VPS, don&#39;t do anything as root. If you can, turn off FTP altogether. If you absolutely need it, consider SFTP instead. Check your system access logs for weirdness regularly. Make routine backups of your filesystem and database so you can recover quickly from problems. Consider signing up with a malware monitoring service - Sucuri happens to offer this, too.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    

    <!-- Site Favicon -->
    <link rel="shortcut icon" href="/assets/images/favicon.ico" type="image/png" />

    <!-- Font Embed Code -->
	<link href="https://fonts.googleapis.com/css?family=Crimson+Text:400,400i,600,600i|Karla:400,400i,700,700i" rel="stylesheet">

    <!-- CSS Styles -->
    <link href="/assets/css/style.css" rel="stylesheet">
</head>



<body class="layout-post">
    <div id="page" class="site">
        <header id="masthead" class="site-header">
    <div class="site-header-wrap">
        <div class="site-header-inside">

            <div class="site-branding">
                
                <p class="profile">
                    <a href="/">
                        <img src="/assets/images/authorimage.jpg" alt="'s Picture"
                            class="avatar" />
                    </a>
                </p>
                <div class="site-identity">
                    
                    <h1 class="site-title">
                        <a href="/">Things that Matter Most</a>
                    </h1>
                    
                    
                    <p class="site-description">Things that Matter Most</p>
                    
                </div><!-- .site-identity -->
                
                <button id="menu-toggle" class="menu-toggle"><span class="screen-reader-text">Main Menu</span><span
                        class="icon-menu" aria-hidden="true"></span></button>
            </div><!-- .site-branding -->

            <nav id="main-navigation" class="site-navigation" aria-label="Main Navigation">
                <div class="site-nav-wrap">
                    <div class="site-nav-inside">
                    <ul class="menu">
                        
                        
                        
                        <li class="menu-item "><a href="/">Home</a></li>
                        
                        
                        
                        <li class="menu-item "><a href="/about">About</a></li>
                        
                        
                        
                        <li class="menu-item "><a href="/contact">Contact Me</a></li>
                        
                        
                        
                        <li class="menu-item "><a href="/search">Search</a></li>
                        
                    </ul>
                    <p class="social-links">
    
    <a href="https://twitter.com/ericmann" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
<!--
Font Awesome Free 5.5.0 by @fontawesome - https://fontawesome.com
License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
-->
    </a>
    
    
    
    <a href="https://github.com/ericmann" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
<!--
Font Awesome Free 5.5.0 by @fontawesome - https://fontawesome.com
License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
-->
    </a>
    
    
    
    
    
    
    
    <a href="https://www.linkedin.com/in/ericallenmann" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
<!--
Font Awesome Free 5.5.0 by @fontawesome - https://fontawesome.com
License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
-->
    </a>
    
    
    
</p>
                    </div><!-- .site-nav-inside -->
                </div><!-- .site-nav-wrap -->
            </nav><!-- .site-navigation -->

        </div><!-- .site-header-inside -->
    </div><!-- .site-header-wrap -->
</header><!-- .site-header -->
        <div id="content" class="site-content fadeInDown delay_075s">
            <div class="inner-wide">
                <main id="main" class="site-main">

    <article class="post-full inner">

        <header class="post-header">
            <div class="post-meta">
                <time class="post-date" datetime="2012-07-31">
                    July 31, 2012
                </time>
            </div><!-- .post-meta -->
            <h1 class="post-title">The Anatomy of an Exploit</h1>
        </header><!-- .post-header -->

        
        <div class="post-content">
            <p>I'm a huge fan of security. I spend many a weekend experimenting with new encryption techniques, hash algorithms, and security protocols.</p>
<p>As a result, I also come across several different server exploits in the wild. PHP hacks, [cci].htaccess[/cci] hacks, JavaScript injection, etc. I once even saw a server hacked through a corrupt PNG image that installed a PHP console when it was loaded.</p>
<p>To a new developer, is is all pretty scary stuff. Here's an example of an exploit I came across last week - and how to both prevent and recover from it.<!--more--></p>
<h2>The Exploit</h2>
<p>A friend alerted the world via Twitter to an odd issue <a title="Undesired Redirect when using Hand-Held Devices" href="http://wordpress.org/support/topic/undesired-redirect-when-using-hand-held-devices">posted in the WordPress forums</a>.  A specific site was being redirected to a Russian website, but <em>only</em> if you visited with a mobile device.</p>
<p>I loaded the website both on my desktop and Android phone to see the difference - sure enough, the page loaded fine on the PC and the phone got Russian spam.</p>
<p>Next, I turned to Fiddler to see what else I could diagnose.</p>
<p>With a desktop user agent, everything came across the wire just fine.  Substituting a mobile user agent string - or any string containing the words "Android" or "iPhone" yielded somewhat different results:</p>
<p><img class="aligncenter size-full wp-image-313" title="Fiddler Malware Scan" src="/assets/2012/07/malware-scan.png" alt="" width="650" height="328" /></p>
<p>There is now a coded block of JavaScript injected above the opening [cci]<!DOCTYPE html SYSTEM>[/cci] tag.  When decoded, this script writes a new script tag to the browser.  This script tag loads a remote URL that forces a redirect from the site you're on to a site of the hacker's choosing.</p>
<p>I followed up with my results in the forums, and mentioned them on Twitter.  That's when Sucuri Security joined the conversation and confirmed this is a known malware bug.</p>
<p>https://twitter.com/sucuri_security/status/227884824885608451</p>
<h2>How To Fix It</h2>
<p>Most known bugs also have known fixes - in this case, the exploit was a poorly secured [cci].htaccess[/cci] file that loads the extra script based on the user agent passed in the request.  Flushing the file is usually enough to remove it.</p>
<p>But that's never enough for me.</p>
<p>Once an attacker has access to your system, they'll likely install more than one back door.  Yes, [cci].htaccess[/cci] is obviously corrupt.  But there might be code lurking in a random PHP or JavaScript file on the server, just waiting to re-infect your site.</p>
<p>The <em>best</em> way to recover <strong>a WordPress site </strong>is to:</p>
<ol>
<li>Change your FTP password (this might be the hacker's original way in)</li>
<li>Change your MySQL password (keep your database secure - also change this in [cci]wp-config.php[/cci])</li>
<li>Check your [cci]wp-config.php[/cci] file <strong>line by line</strong> to make sure it's clean. Compare it to the [cci]wp-config-sample.php[/cci] file from a <strong>fresh download </strong>of WordPress to be sure.</li>
<li>Reinstall WordPress. This means deleting <strong><em>everything</em></strong><em></em>except for your configuration file, themes, and plugins
<ul>
<li>Ideally, you'll also remove all themes and plugins and reinstall them from clean sources as well. If you can't, make sure you go through each line of every PHP file and make sure there isn't anything hinky going on there.[ref]Yes, I did just use the word hinky in a professional post. Get over it. :-)[/ref]</li>
</ul>
</li>
<li>Go through your entire [cci]/uploads[/cci] directoy and make sure no rogue files or scripts are lying around</li>
<li>Restore your database from the most recent (clean) backup
<ul>
<li>If you don't have a backup, get ready for a long night of going through data tables manually to be sure there isn't anything hiding in the database</li>
<li>And really, why <em>don't</em> you have an automated backup? Set one up now while you're at it!</li>
</ul>
</li>
<li>Ask another developer to double check your work to be sure you haven't missed anything.</li>
</ol>
<p>In a pinch, you can also hire the experts at <a title="Sucuri Security" href="http://sucuri.net/">Sucuri</a> to clean things up for you. They know what they're doing and have likely cleaned up this specific hack already.</p>
<h2>Don't Get Hacked in the First Place</h2>
<p>There's quite a bit you can do to <a title="Hardening WordPress" href="http://codex.wordpress.org/Hardening_WordPress">harden your site</a> <em>before</em> it gets hacked. Here are just a few quick recommendations:</p>
<ul>
<li>Change your WordPress admin password regularly. And don't use the same password anywhere else.</li>
<li>Use different passwords and logins for WordPress admin, FTP, and MySQL.</li>
<li>If you're running your own VPS, don't do <em>anything</em> as root.</li>
<li>If you can, turn off FTP altogether. If you absolutely need it, consider SFTP instead.</li>
<li>Check your system access logs for weirdness regularly.</li>
<li>Make routine backups of your filesystem and database so you can recover quickly from problems.</li>
<li>Consider signing up with a malware monitoring service - <a title="Sucuri Security" href="http://sucuri.net/">Sucuri</a> happens to offer this, too.</li>
</ul>

        </div>
        <footer class="post-footer">
            <div class="post-share">
                <span class="post-share-title">Share:</span>
                <a target="_blank"
                    href="https://twitter.com/share?text=The+Anatomy+of+an+Exploit&amp;url=https://ttmm.iotutorial/the-anatomy-of-an-exploit/">Twitter</a>
                <a target="_blank"
                    href="https://www.facebook.com/sharer/sharer.php?u=https://ttmm.iotutorial/the-anatomy-of-an-exploit/">Facebook</a>
            </div><!-- .share-post -->
            
            <p class="post-cats">
                <span class="post-share-title">Filed under </span>
                <a href="/categories/index.html#JavaScript"
                    rel="category">JavaScript</a>
                <a href="/categories/index.html#Tutorials"
                    rel="category">Tutorials</a>
                
            </p>
            
            
            <p class="post-tags">
                <span class="post-share-title">Tagged with </span>
                <a href="/tags/index.html#security"
                    rel="tag">security</a>
                <a href="/tags/index.html#WordPress"
                    rel="tag">WordPress</a>
                
            </p>
            
        </footer>
        
    </article>
    
    <section class="read-next inner">
        <h2 class="read-next-title">Read Next</h2>
        
        <article class="post">
            <header class="post-header">
                <div class="post-meta">
                    <time class="published" datetime="July 27, 2012">July 27, 2012</time>
                </div>
                <h3 class="post-title"><a href="/faith/goodbye-my-friend/">Goodbye, My Friend</a>
                </h3>
            </header>
        </article>
        
        
        <article class="post">
            <header class="post-header">
                <div class="post-meta">
                    <time class="published" datetime="August 6, 2012">August 6, 2012</time>
                </div>
                <h3 class="post-title"><a href="/faith/character-quest-service/">Character Quest - Service</a></h3>
            </header>
        </article>
        
    </section><!-- .read-next -->

</main><!-- .site-main -->


                

                
                <footer id="colophon" class="site-footer">
    <p class="site-info inner">
        <a href="#">Things that Matter Most</a> &copy; 2021. Royce theme by
        <a target="_blank" href="https://justgoodthemes.com/">JustGoodThemes</a>.
        <br />
        Powered by <a target="_blank" href="https://jekyllrb.com/">Jekyll</a>.
    </p>
    <a id="back-to-top" class="back-to-top" href="#page">
        <span class="icon-arrow-up" aria-hidden="true"></span>
        <span class="screen-reader-text">Back to top</span>
    </a>
</footer><!-- .site-footer -->
            </div><!-- .inner-wide -->
        </div><!-- .site-content -->
    </div><!-- .site -->

    
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-4156949-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-4156949-6', { 'anonymize_ip': true });
  </script>

    <!-- Javascript Assets -->
    <script src="/assets/js/jquery-3.3.1.min.js"></script>
    <script src="/assets/js/plugins.js"></script>
    <script src="/assets/js/custom.js"></script>

</body>

</html>