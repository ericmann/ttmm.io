<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
        <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Query, Template, Actions as MVC in WordPress | Things that Matter Most</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Query, Template, Actions as MVC in WordPress" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I love WordPress. I also love MVC design fundamentals. Unfortunately, these two loves of mine are at odds with one another, and that makes me sad. Here’s my simple idea to make WordPress’ built-in templating engine play nice with MVC sensibilities - everyone can win!" />
<meta property="og:description" content="I love WordPress. I also love MVC design fundamentals. Unfortunately, these two loves of mine are at odds with one another, and that makes me sad. Here’s my simple idea to make WordPress’ built-in templating engine play nice with MVC sensibilities - everyone can win!" />
<meta property="og:site_name" content="Things that Matter Most" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2013-12-12T21:22:52-08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Query, Template, Actions as MVC in WordPress" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Query, Template, Actions as MVC in WordPress","dateModified":"2013-12-12T21:22:52-08:00","datePublished":"2013-12-12T21:22:52-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/tech/wordpress-mvc/"},"url":"/tech/wordpress-mvc/","description":"I love WordPress. I also love MVC design fundamentals. Unfortunately, these two loves of mine are at odds with one another, and that makes me sad. Here’s my simple idea to make WordPress’ built-in templating engine play nice with MVC sensibilities - everyone can win!","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    

    <!-- Site Favicon -->
    <link rel="shortcut icon" href="/assets/images/favicon.ico" type="image/png" />

    <!-- Font Embed Code -->
	<link href="https://fonts.googleapis.com/css?family=Crimson+Text:400,400i,600,600i|Karla:400,400i,700,700i" rel="stylesheet">

    <!-- CSS Styles -->
    <link href="/assets/css/style.css" rel="stylesheet">
</head>



<body class="layout-post">
    <div id="page" class="site">
        <header id="masthead" class="site-header">
    <div class="site-header-wrap">
        <div class="site-header-inside">

            <div class="site-branding">
                
                <p class="profile">
                    <a href="/">
                        <img src="/assets/images/authorimage.jpg" alt="'s Picture"
                            class="avatar" />
                    </a>
                </p>
                <div class="site-identity">
                    
                    <h1 class="site-title">
                        <a href="/">Things that Matter Most</a>
                    </h1>
                    
                    
                    <p class="site-description">Things that Matter Most</p>
                    
                </div><!-- .site-identity -->
                
                <button id="menu-toggle" class="menu-toggle"><span class="screen-reader-text">Main Menu</span><span
                        class="icon-menu" aria-hidden="true"></span></button>
            </div><!-- .site-branding -->

            <nav id="main-navigation" class="site-navigation" aria-label="Main Navigation">
                <div class="site-nav-wrap">
                    <div class="site-nav-inside">
                    <ul class="menu">
                        
                        
                        
                        <li class="menu-item "><a href="/">Home</a></li>
                        
                        
                        
                        <li class="menu-item "><a href="/about">About</a></li>
                        
                        
                        
                        <li class="menu-item "><a href="/contact">Contact Me</a></li>
                        
                        
                        
                        <li class="menu-item "><a href="/search">Search</a></li>
                        
                    </ul>
                    <p class="social-links">
    
    <a href="https://twitter.com/ericmann" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
<!--
Font Awesome Free 5.5.0 by @fontawesome - https://fontawesome.com
License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
-->
    </a>
    
    
    
    <a href="https://github.com/ericmann" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
<!--
Font Awesome Free 5.5.0 by @fontawesome - https://fontawesome.com
License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
-->
    </a>
    
    
    
    
    
    
    
    <a href="https://www.linkedin.com/in/ericallenmann" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
<!--
Font Awesome Free 5.5.0 by @fontawesome - https://fontawesome.com
License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
-->
    </a>
    
    
    
</p>
                    </div><!-- .site-nav-inside -->
                </div><!-- .site-nav-wrap -->
            </nav><!-- .site-navigation -->

        </div><!-- .site-header-inside -->
    </div><!-- .site-header-wrap -->
</header><!-- .site-header -->
        <div id="content" class="site-content fadeInDown delay_075s">
            <div class="inner-wide">
                <main id="main" class="site-main">

    <article class="post-full inner">

        <header class="post-header">
            <div class="post-meta">
                <time class="post-date" datetime="2013-12-12">
                    December 12, 2013
                </time>
            </div><!-- .post-meta -->
            <h1 class="post-title">Query, Template, Actions as MVC in WordPress</h1>
        </header><!-- .post-header -->

        
        <div class="post-content">
            <p><strong>12/13/2013 Update:</strong> I've added a first run at a feature plugin for the idea proposed below to <a href="https://github.com/ericmann/MVPress" title="MVPress on GitHub">GitHub</a>. Feel free to play with the code, make improvements, or suggest alternatives!</p>
<hr />
<p>I love WordPress.  I also love MVC design fundamentals.  Unfortunately, these two loves of mine are at odds with one another, and that makes me sad.</p>
<p>WordPress, at its core, is a procedural, template-driven framework.  This is a good thing, as procedural code is easier for many to learn than object-oriented code.  The templatey goodness of the framework helps contribute to a very DRY front-end without forcing developers to learn a convoluted[ref]This is a dangerous statement as many consider the WordPress theme structure to be fairly convoluted.  If you start small, though, you can get away with a single template file and abstract from there.  This option is, in my view at least, far easier to work with than many others.[/ref] framework.  At the same time, it introduces a bad practice into theming by way of global variables.</p>
<p><span style="line-height: 1.5em;">My suggestion is to rewrite [cci]get_template_part()[/cci] just a bit.  I've actually done this already for a client project, and the new approach works wonders!</span></p>
<h2>An Alternative</h2>
<p>Right now, [cci]get_template_part()[/cci] is very simple.  It scans the active theme (and parent theme, if applicable) for a specifically-named template file and, when found, [cci]include()[/cci]s it in the site's execution.  Simple, straight-forward, easy-to-use.</p>
<p>Just not very MVC-like.</p>
<p>The alternative I built for my client used a namespace[ref]This is a PHP 5.3 feature and, so long as WordPress' minimum requirement is PHP 5.2, I can't just roll my client's code into WordPress core.  No shortcuts.  Sorry.[/ref] to redefine the function within the scope of the theme alone - in other words, I replaced [cci]get_template_part()[/cci] <em>without</em> hacking core.</p>
<p>This <em>new</em> function still matched the standard WordPress function's behavior; it also augmented it in a way.</p>
<p>WordPress would still scan the theme (and parent, if applicable) to find the appropriately-named template file.  Rather than include the file directly, the new function wraps the template file in a [cci]Template[/cci] object.  This object's [cci]->render()[/cci] method is then invoked, which in turn includes the template as before.</p>
<p>Why is this important exactly?</p>
<p>The [cci]Template[/cci] object defines two protected fields, [cci]$context[/cci] and [cci]$model[/cci].  I'll get back to the context parameter in a moment.</p>
<h2>The Model</h2>
<p>The template's [cci]$model[/cci] property is typically null.  However, the <em>new</em> [cci]get_template_part()[/cci] function accepts an optional third parameter of any type.  You can pass <em>any</em> object or variable you want as this argument and it automatically becomes available as [cci]$this->model[/cci] within the scope of your template file.</p>
<p>You can explicitly pass a data model to the template file, your "view," without the need to use an ugly global variable.</p>
<h2>The Context</h2>
<p>The [cci]$context[/cci] object is an instance of a special [cci]TemplateContext[/cci] object.  This object includes a few helpful things:</p>
<ul>
<li>A reference to the current [cci]WP_Query[/cci] instance</li>
<li>A reference to the [cci]$_REQUEST[/cci] supergobal</li>
<li>A special, user-defined [cci]$temp_data[/cci] array</li>
</ul>
<p>Not only can you reference your no-longer-global data model, you can now reference [cci]$this->context->query[/cci] rather than a global [cci]$query[/cci] variable!</p>
<p>The temporary data array can contain anything you want.  Think of it as a custom go-between for additional contextual data you might need in a view that's not part of the model.  The sky's the limit.</p>
<h2>My Dilemma</h2>
<p>Anyone who's worked with an MVC framework can likely see the benefit this kind of change would have for WordPress.  At the same time, it's drawbacks would be minimal.  The new function signature is essentially identical to the old one - the two new parameters it takes for the model and temporary data array are optional - so the new logic is a drop-in replacement for the old.</p>
<p>Your themes will still work.  Your plugins will still work.  Anything hooking on to the [cci]get_template_part_{slug}[/cci] action will still work.</p>
<p>My dilemma isn't backwards compatibility - my dilemma is how to get this code into your hands for testing.</p>
<p>WordPress' new rapid release pattern encourages introducing new features as plugins.  I want to, but I'm not quite sure how to make that work ...</p>
<p>In my client's site, I replaced [cci]get_template_part()[/cci] by redefining it in a proprietary namespace - this isn't an option for a general WordPress release.  The structure of the [cci]general-template.php[/cci] file also makes it hard to hook in and replace the functionality of the function without also breaking any plugins (or themes) that also hook in there.</p>
<p>Alternatively, I could just ship this as a core patch, but that makes testing more difficult for developers now accustomed to the plugins-as-features approach, meaning the patch will likely grow stale on Trac.</p>
<p>So now I reach out to you: How can I replace [cci]get_template_part()[/cci] with a plugin so you can test the new functionality without hacking core?  Alternatively, would you be willing to test this functionality via a patch instead?</p>

        </div>
        <footer class="post-footer">
            <div class="post-share">
                <span class="post-share-title">Share:</span>
                <a target="_blank"
                    href="https://twitter.com/share?text=Query%2C+Template%2C+Actions+as+MVC+in+WordPress&amp;url=https://ttmm.iotech/wordpress-mvc/">Twitter</a>
                <a target="_blank"
                    href="https://www.facebook.com/sharer/sharer.php?u=https://ttmm.iotech/wordpress-mvc/">Facebook</a>
            </div><!-- .share-post -->
            
            <p class="post-cats">
                <span class="post-share-title">Filed under </span>
                <a href="/categories/index.html#Technology"
                    rel="category">Technology</a>
                
            </p>
            
            
            <p class="post-tags">
                <span class="post-share-title">Tagged with </span>
                <a href="/tags/index.html#core+patch"
                    rel="tag">core patch</a>
                <a href="/tags/index.html#MVC"
                    rel="tag">MVC</a>
                <a href="/tags/index.html#template"
                    rel="tag">template</a>
                <a href="/tags/index.html#theme"
                    rel="tag">theme</a>
                <a href="/tags/index.html#WordPress"
                    rel="tag">WordPress</a>
                
            </p>
            
        </footer>
        
    </article>
    
    <section class="read-next inner">
        <h2 class="read-next-title">Read Next</h2>
        
        <article class="post">
            <header class="post-header">
                <div class="post-meta">
                    <time class="published" datetime="December 7, 2013">December 7, 2013</time>
                </div>
                <h3 class="post-title"><a href="/journal/crowdfunding-new-years-goal/">Crowdfunding a New Year's Goal</a>
                </h3>
            </header>
        </article>
        
        
        <article class="post">
            <header class="post-header">
                <div class="post-meta">
                    <time class="published" datetime="December 18, 2013">December 18, 2013</time>
                </div>
                <h3 class="post-title"><a href="/journal/opinions-i-have-them/">Opinions. I Have Them.</a></h3>
            </header>
        </article>
        
    </section><!-- .read-next -->

</main><!-- .site-main -->


                

                
                <footer id="colophon" class="site-footer">
    <p class="site-info inner">
        <a href="#">Things that Matter Most</a> &copy; 2021. Royce theme by
        <a target="_blank" href="https://justgoodthemes.com/">JustGoodThemes</a>.
        <br />
        Powered by <a target="_blank" href="https://jekyllrb.com/">Jekyll</a>.
    </p>
    <a id="back-to-top" class="back-to-top" href="#page">
        <span class="icon-arrow-up" aria-hidden="true"></span>
        <span class="screen-reader-text">Back to top</span>
    </a>
</footer><!-- .site-footer -->
            </div><!-- .inner-wide -->
        </div><!-- .site-content -->
    </div><!-- .site -->

    
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-4156949-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-4156949-6', { 'anonymize_ip': true });
  </script>

    <!-- Javascript Assets -->
    <script src="/assets/js/jquery-3.3.1.min.js"></script>
    <script src="/assets/js/plugins.js"></script>
    <script src="/assets/js/custom.js"></script>

</body>

</html>