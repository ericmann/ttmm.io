<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
        <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Theme-ready Shortcodes in WordPress | Things that Matter Most</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Theme-ready Shortcodes in WordPress" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A few months back, I taught you how to make your widgets theme-ready by extracting the actual markup into an overridable template.  Now, we&#39;re going to do the same for shortcodes. And for those of you wanting to see this in practice, stay tuned for the release of version 2.5 of WP Publication Archive in a few weeks.  I&#39;m using this technique to make markup easy to change. Why Use Templates? The beauty of WordPress is its flexibility.  With a limited amount of technical know-how, you can build a website in minutes that looks completely different from anything else built on the same platform.  It can be as unique as you want and as customized to you as can be. This flexibility is extended through WordPress&#39; theme system.  If you have a WordPress site, you&#39;ve used a theme.  What you might now know about the theme, though, is it&#39;s just a template. WordPress populates a few code objects based on the queried page (whatever link you followed to get to the site), then hands those objects off to the loaded template to render things to the page.  It&#39;s flexible, because WordPress doesn&#39;t know (or need to know) anything about the template.  You can render your content as HTML, XML, JSON, or whatever other capitalized acronym you want. We&#39;re going to use a template for our shortcode for the very same reason - our plugin will provide a default display for the content, but really that can be replaced by any other template the end user chooses. Populating the Data It doesn&#39;t really matter how you build your data so long as you&#39;re precise in the way your data is constructed and used.  The new version of WP Publication Archive, for example, globalizes a variable and populates it with an array.  This array contains, among other things, a collection of publications that need to be displayed whenever the user enters the [cci][wp-publication-archive][/cci] shortcode. The variable has to be global in scope so that the template can access it.  Be very precise with your global object name so no other plugins step all over it.  It might also be a good idea to pass the object through a filter before loading the template as well to provide the highest level of flexibility possible: // Get a global container variable and populate it with our data global $wppa_container; $wppa_container = array( &#39;publications&#39; =&gt; $publications, &#39;total_pubs&#39; =&gt; $total_pubs, &#39;limit&#39; =&gt; $limit, &#39;offset&#39; =&gt; $offset, &#39;paged&#39; =&gt; $paged, &#39;post&#39; =&gt; $post ); $wppa_container = apply_filters( &#39;wppa_publication_list_container&#39;, $wppa_container ); Loading the Template Now we actually load of the template.  Be sure to set an easy-to-remember name - I typically prefix my template files with [cci]template.[/cci] so I can remember which files in the plugin might be overridden by a theme.  A descriptive name will also help users know what the file is for: // Get the publication list template $template_name = apply_filters( &#39;wppa_list_template&#39;, &#39;template.wppa_publication_list.php&#39; ); $path = locate_template( $template_name ); if ( empty( $path ) ) { $path = WP_PUB_ARCH_DIR . &#39;includes/&#39; . $template_name; }&lt;/p&gt; // Start a buffer to capture the HTML output of the shortcode. ob_start(); include( $path ); $output = ob_get_contents(); ob_end_clean(); // Because globals are evil, clean up afterwards. unset( $wppa_container ); return $output; &lt;/code&gt; The idea behind this code is to check first if the theme has a similarly-named file.  If so, load that one up.  This file is placed either by the theme developer or the end user specifically to work with your plugin.  Make sure you respect that and defer to their markup.  If the file doesn&#39;t exist, though, load some kind of fallback from within the plugin. This fallback file should serve as an example to other developers how you think content should appear, but it is not a strict expectation.  Consider it more of an example for how to build a shortcode template. Output Buffer Notice in this example I&#39;m using an output buffer.  Normally, I wouldn&#39;t encourage that.  Shortcodes, thought, return data rather than output the data.  But template files should always be geared towards presentation. It&#39;s easiest to write the template file as if it&#39;s an output file.  Use raw HTML and php&#39;s [cci]echo[/cci] to generate things.  This way it stays in-line with the widget templates we&#39;ve done before and with themes (as templates) as well. Building Markup The shortcode template should have no functionality or logic.  Zero. None. The template file is 100% markup.  You might throw in a loop or two to iterate through collections, but there should be no queries or other data fetching in the file.  Everything you&#39;re looping through should be provided in the global object you passed in earlier. The end user might elect to add their own additional logic (third party plugins might add meta to your plugin), and they can definitely do that.  But you, as the initial developer, should not.  Keep it simple. extract( $wppa_container ); ?&gt;&lt;/p&gt; ID, $publication-&gt;post_title, $publication-&gt;post_date ); ?&gt;&lt;/p&gt; the_thumbnail(); ?&gt; the_title(); ?&gt; the_authors(); ?&gt; the_uri(); ?&gt; the_summary(); ?&gt; the_keywords(); ?&gt; the_categories(); ?&gt; &lt;/div&gt; &lt;/code&gt; What&#39;s Next? From here, any developer can drop a [cci]template.wppa_publication_list.php[/cci] file into their theme and replace my default markup with whatever custom markup they choose.  They can use only HTML tags ([cci] &lt; aside&gt;[/cci], [cci] &lt; section&gt;[/cci], and the like), they can write out XML, they can reposition elements, etc.  It&#39;s entirely up to them. But the end user only ever has to enter one shortcode.  Like I said, simple. Other plugin developers can also hook into the template loading process and inject some custom template as well.  Perhaps another plugin is built to specifically extend WP Publication Archive to add additional meta information and markup - they can hook in and add their own template instead." />
<meta property="og:description" content="A few months back, I taught you how to make your widgets theme-ready by extracting the actual markup into an overridable template.  Now, we&#39;re going to do the same for shortcodes. And for those of you wanting to see this in practice, stay tuned for the release of version 2.5 of WP Publication Archive in a few weeks.  I&#39;m using this technique to make markup easy to change. Why Use Templates? The beauty of WordPress is its flexibility.  With a limited amount of technical know-how, you can build a website in minutes that looks completely different from anything else built on the same platform.  It can be as unique as you want and as customized to you as can be. This flexibility is extended through WordPress&#39; theme system.  If you have a WordPress site, you&#39;ve used a theme.  What you might now know about the theme, though, is it&#39;s just a template. WordPress populates a few code objects based on the queried page (whatever link you followed to get to the site), then hands those objects off to the loaded template to render things to the page.  It&#39;s flexible, because WordPress doesn&#39;t know (or need to know) anything about the template.  You can render your content as HTML, XML, JSON, or whatever other capitalized acronym you want. We&#39;re going to use a template for our shortcode for the very same reason - our plugin will provide a default display for the content, but really that can be replaced by any other template the end user chooses. Populating the Data It doesn&#39;t really matter how you build your data so long as you&#39;re precise in the way your data is constructed and used.  The new version of WP Publication Archive, for example, globalizes a variable and populates it with an array.  This array contains, among other things, a collection of publications that need to be displayed whenever the user enters the [cci][wp-publication-archive][/cci] shortcode. The variable has to be global in scope so that the template can access it.  Be very precise with your global object name so no other plugins step all over it.  It might also be a good idea to pass the object through a filter before loading the template as well to provide the highest level of flexibility possible: // Get a global container variable and populate it with our data global $wppa_container; $wppa_container = array( &#39;publications&#39; =&gt; $publications, &#39;total_pubs&#39; =&gt; $total_pubs, &#39;limit&#39; =&gt; $limit, &#39;offset&#39; =&gt; $offset, &#39;paged&#39; =&gt; $paged, &#39;post&#39; =&gt; $post ); $wppa_container = apply_filters( &#39;wppa_publication_list_container&#39;, $wppa_container ); Loading the Template Now we actually load of the template.  Be sure to set an easy-to-remember name - I typically prefix my template files with [cci]template.[/cci] so I can remember which files in the plugin might be overridden by a theme.  A descriptive name will also help users know what the file is for: // Get the publication list template $template_name = apply_filters( &#39;wppa_list_template&#39;, &#39;template.wppa_publication_list.php&#39; ); $path = locate_template( $template_name ); if ( empty( $path ) ) { $path = WP_PUB_ARCH_DIR . &#39;includes/&#39; . $template_name; }&lt;/p&gt; // Start a buffer to capture the HTML output of the shortcode. ob_start(); include( $path ); $output = ob_get_contents(); ob_end_clean(); // Because globals are evil, clean up afterwards. unset( $wppa_container ); return $output; &lt;/code&gt; The idea behind this code is to check first if the theme has a similarly-named file.  If so, load that one up.  This file is placed either by the theme developer or the end user specifically to work with your plugin.  Make sure you respect that and defer to their markup.  If the file doesn&#39;t exist, though, load some kind of fallback from within the plugin. This fallback file should serve as an example to other developers how you think content should appear, but it is not a strict expectation.  Consider it more of an example for how to build a shortcode template. Output Buffer Notice in this example I&#39;m using an output buffer.  Normally, I wouldn&#39;t encourage that.  Shortcodes, thought, return data rather than output the data.  But template files should always be geared towards presentation. It&#39;s easiest to write the template file as if it&#39;s an output file.  Use raw HTML and php&#39;s [cci]echo[/cci] to generate things.  This way it stays in-line with the widget templates we&#39;ve done before and with themes (as templates) as well. Building Markup The shortcode template should have no functionality or logic.  Zero. None. The template file is 100% markup.  You might throw in a loop or two to iterate through collections, but there should be no queries or other data fetching in the file.  Everything you&#39;re looping through should be provided in the global object you passed in earlier. The end user might elect to add their own additional logic (third party plugins might add meta to your plugin), and they can definitely do that.  But you, as the initial developer, should not.  Keep it simple. extract( $wppa_container ); ?&gt;&lt;/p&gt; ID, $publication-&gt;post_title, $publication-&gt;post_date ); ?&gt;&lt;/p&gt; the_thumbnail(); ?&gt; the_title(); ?&gt; the_authors(); ?&gt; the_uri(); ?&gt; the_summary(); ?&gt; the_keywords(); ?&gt; the_categories(); ?&gt; &lt;/div&gt; &lt;/code&gt; What&#39;s Next? From here, any developer can drop a [cci]template.wppa_publication_list.php[/cci] file into their theme and replace my default markup with whatever custom markup they choose.  They can use only HTML tags ([cci] &lt; aside&gt;[/cci], [cci] &lt; section&gt;[/cci], and the like), they can write out XML, they can reposition elements, etc.  It&#39;s entirely up to them. But the end user only ever has to enter one shortcode.  Like I said, simple. Other plugin developers can also hook into the template loading process and inject some custom template as well.  Perhaps another plugin is built to specifically extend WP Publication Archive to add additional meta information and markup - they can hook in and add their own template instead." />
<meta property="og:site_name" content="Things that Matter Most" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2012-10-05T08:00:28-07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Theme-ready Shortcodes in WordPress" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Theme-ready Shortcodes in WordPress","dateModified":"2012-10-05T08:00:28-07:00","datePublished":"2012-10-05T08:00:28-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"/php/theme-ready-shortcodes-in-wordpress/"},"url":"/php/theme-ready-shortcodes-in-wordpress/","description":"A few months back, I taught you how to make your widgets theme-ready by extracting the actual markup into an overridable template.  Now, we&#39;re going to do the same for shortcodes. And for those of you wanting to see this in practice, stay tuned for the release of version 2.5 of WP Publication Archive in a few weeks.  I&#39;m using this technique to make markup easy to change. Why Use Templates? The beauty of WordPress is its flexibility.  With a limited amount of technical know-how, you can build a website in minutes that looks completely different from anything else built on the same platform.  It can be as unique as you want and as customized to you as can be. This flexibility is extended through WordPress&#39; theme system.  If you have a WordPress site, you&#39;ve used a theme.  What you might now know about the theme, though, is it&#39;s just a template. WordPress populates a few code objects based on the queried page (whatever link you followed to get to the site), then hands those objects off to the loaded template to render things to the page.  It&#39;s flexible, because WordPress doesn&#39;t know (or need to know) anything about the template.  You can render your content as HTML, XML, JSON, or whatever other capitalized acronym you want. We&#39;re going to use a template for our shortcode for the very same reason - our plugin will provide a default display for the content, but really that can be replaced by any other template the end user chooses. Populating the Data It doesn&#39;t really matter how you build your data so long as you&#39;re precise in the way your data is constructed and used.  The new version of WP Publication Archive, for example, globalizes a variable and populates it with an array.  This array contains, among other things, a collection of publications that need to be displayed whenever the user enters the [cci][wp-publication-archive][/cci] shortcode. The variable has to be global in scope so that the template can access it.  Be very precise with your global object name so no other plugins step all over it.  It might also be a good idea to pass the object through a filter before loading the template as well to provide the highest level of flexibility possible: // Get a global container variable and populate it with our data global $wppa_container; $wppa_container = array( &#39;publications&#39; =&gt; $publications, &#39;total_pubs&#39; =&gt; $total_pubs, &#39;limit&#39; =&gt; $limit, &#39;offset&#39; =&gt; $offset, &#39;paged&#39; =&gt; $paged, &#39;post&#39; =&gt; $post ); $wppa_container = apply_filters( &#39;wppa_publication_list_container&#39;, $wppa_container ); Loading the Template Now we actually load of the template.  Be sure to set an easy-to-remember name - I typically prefix my template files with [cci]template.[/cci] so I can remember which files in the plugin might be overridden by a theme.  A descriptive name will also help users know what the file is for: // Get the publication list template $template_name = apply_filters( &#39;wppa_list_template&#39;, &#39;template.wppa_publication_list.php&#39; ); $path = locate_template( $template_name ); if ( empty( $path ) ) { $path = WP_PUB_ARCH_DIR . &#39;includes/&#39; . $template_name; }&lt;/p&gt; // Start a buffer to capture the HTML output of the shortcode. ob_start(); include( $path ); $output = ob_get_contents(); ob_end_clean(); // Because globals are evil, clean up afterwards. unset( $wppa_container ); return $output; &lt;/code&gt; The idea behind this code is to check first if the theme has a similarly-named file.  If so, load that one up.  This file is placed either by the theme developer or the end user specifically to work with your plugin.  Make sure you respect that and defer to their markup.  If the file doesn&#39;t exist, though, load some kind of fallback from within the plugin. This fallback file should serve as an example to other developers how you think content should appear, but it is not a strict expectation.  Consider it more of an example for how to build a shortcode template. Output Buffer Notice in this example I&#39;m using an output buffer.  Normally, I wouldn&#39;t encourage that.  Shortcodes, thought, return data rather than output the data.  But template files should always be geared towards presentation. It&#39;s easiest to write the template file as if it&#39;s an output file.  Use raw HTML and php&#39;s [cci]echo[/cci] to generate things.  This way it stays in-line with the widget templates we&#39;ve done before and with themes (as templates) as well. Building Markup The shortcode template should have no functionality or logic.  Zero. None. The template file is 100% markup.  You might throw in a loop or two to iterate through collections, but there should be no queries or other data fetching in the file.  Everything you&#39;re looping through should be provided in the global object you passed in earlier. The end user might elect to add their own additional logic (third party plugins might add meta to your plugin), and they can definitely do that.  But you, as the initial developer, should not.  Keep it simple. extract( $wppa_container ); ?&gt;&lt;/p&gt; ID, $publication-&gt;post_title, $publication-&gt;post_date ); ?&gt;&lt;/p&gt; the_thumbnail(); ?&gt; the_title(); ?&gt; the_authors(); ?&gt; the_uri(); ?&gt; the_summary(); ?&gt; the_keywords(); ?&gt; the_categories(); ?&gt; &lt;/div&gt; &lt;/code&gt; What&#39;s Next? From here, any developer can drop a [cci]template.wppa_publication_list.php[/cci] file into their theme and replace my default markup with whatever custom markup they choose.  They can use only HTML tags ([cci] &lt; aside&gt;[/cci], [cci] &lt; section&gt;[/cci], and the like), they can write out XML, they can reposition elements, etc.  It&#39;s entirely up to them. But the end user only ever has to enter one shortcode.  Like I said, simple. Other plugin developers can also hook into the template loading process and inject some custom template as well.  Perhaps another plugin is built to specifically extend WP Publication Archive to add additional meta information and markup - they can hook in and add their own template instead.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    

    <!-- Site Favicon -->
    <link rel="shortcut icon" href="/assets/images/favicon.ico" type="image/png" />

    <!-- Font Embed Code -->
	<link href="https://fonts.googleapis.com/css?family=Crimson+Text:400,400i,600,600i|Karla:400,400i,700,700i" rel="stylesheet">

    <!-- CSS Styles -->
    <link href="/assets/css/style.css" rel="stylesheet">
</head>



<body class="layout-post">
    <div id="page" class="site">
        <header id="masthead" class="site-header">
    <div class="site-header-wrap">
        <div class="site-header-inside">

            <div class="site-branding">
                
                <p class="profile">
                    <a href="/">
                        <img src="/assets/images/authorimage.jpg" alt="'s Picture"
                            class="avatar" />
                    </a>
                </p>
                <div class="site-identity">
                    
                    <h1 class="site-title">
                        <a href="/">Things that Matter Most</a>
                    </h1>
                    
                    
                    <p class="site-description">Things that Matter Most</p>
                    
                </div><!-- .site-identity -->
                
                <button id="menu-toggle" class="menu-toggle"><span class="screen-reader-text">Main Menu</span><span
                        class="icon-menu" aria-hidden="true"></span></button>
            </div><!-- .site-branding -->

            <nav id="main-navigation" class="site-navigation" aria-label="Main Navigation">
                <div class="site-nav-wrap">
                    <div class="site-nav-inside">
                    <ul class="menu">
                        
                        
                        
                        <li class="menu-item "><a href="/">Home</a></li>
                        
                        
                        
                        <li class="menu-item "><a href="/about">About</a></li>
                        
                        
                        
                        <li class="menu-item "><a href="/contact">Contact Me</a></li>
                        
                        
                        
                        <li class="menu-item "><a href="/search">Search</a></li>
                        
                    </ul>
                    <p class="social-links">
    
    <a href="https://twitter.com/ericmann" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
<!--
Font Awesome Free 5.5.0 by @fontawesome - https://fontawesome.com
License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
-->
    </a>
    
    
    
    <a href="https://github.com/ericmann" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
<!--
Font Awesome Free 5.5.0 by @fontawesome - https://fontawesome.com
License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
-->
    </a>
    
    
    
    
    
    
    
    <a href="https://www.linkedin.com/in/ericallenmann" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
<!--
Font Awesome Free 5.5.0 by @fontawesome - https://fontawesome.com
License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
-->
    </a>
    
    
    
</p>
                    </div><!-- .site-nav-inside -->
                </div><!-- .site-nav-wrap -->
            </nav><!-- .site-navigation -->

        </div><!-- .site-header-inside -->
    </div><!-- .site-header-wrap -->
</header><!-- .site-header -->
        <div id="content" class="site-content fadeInDown delay_075s">
            <div class="inner-wide">
                <main id="main" class="site-main">

    <article class="post-full inner">

        <header class="post-header">
            <div class="post-meta">
                <time class="post-date" datetime="2012-10-05">
                    October 5, 2012
                </time>
            </div><!-- .post-meta -->
            <h1 class="post-title">Theme-ready Shortcodes in WordPress</h1>
        </header><!-- .post-header -->

        
        <div class="post-content">
            <p>A few months back, I taught you how to <a title="Theme-ready Widgets in WordPress" href="https://ttmm.io/tutorial/theme-ready-widgets-in-wordpress/">make your widgets theme-ready</a> by extracting the actual markup into an overridable template.  Now, we're going to do the same for shortcodes.</p>
<p>And for those of you wanting to see this in practice, stay tuned for the release of version 2.5 of WP Publication Archive in a few weeks.  I'm using this technique to make markup easy to change.<!--more--></p>
<h2>Why Use Templates?</h2>
<p>The beauty of WordPress is its flexibility.  With a limited amount of technical know-how, you can build a website in minutes that looks completely different from anything else built on the same platform.  It can be as unique as you want and as customized to you as can be.</p>
<p>This flexibility is extended through WordPress' theme system.  If you have a WordPress site, you've used a theme.  What you might now know about the theme, though, is it's just a template.</p>
<p>WordPress populates a few code objects based on the queried page (whatever link you followed to get to the site), then hands those objects off to the loaded template to render things to the page.  It's flexible, because WordPress doesn't know (or need to know) anything about the template.  You can render your content as HTML, XML, <a title="JSON Api" href="http://wordpress.org/extend/plugins/json-api/">JSON</a>, or whatever other capitalized acronym you want.</p>
<p>We're going to use a template for our shortcode for the very same reason - our plugin will provide a <em>default</em> display for the content, but really that can be replaced by any other template the end user chooses.</p>
<h2>Populating the Data</h2>
<p>It doesn't really matter <em>how</em> you build your data so long as you're precise in the way your data is constructed and used.  The new version of WP Publication Archive, for example, globalizes a variable and populates it with an array.  This array contains, among other things, a collection of publications that need to be displayed whenever the user enters the [cci][wp-publication-archive][/cci] shortcode.</p>
<p>The variable has to be global in scope so that the template can access it.  Be <em>very precise</em> with your global object name so no other plugins step all over it.  It might also be a good idea to pass the object through a filter before loading the template as well to provide the highest level of flexibility possible:</p>
<p><code lang="php"><br />
// Get a global container variable and populate it with our data<br />
global $wppa_container;<br />
$wppa_container = array(<br />
    'publications' => $publications,<br />
    'total_pubs'   => $total_pubs,<br />
    'limit'        => $limit,<br />
    'offset'       => $offset,<br />
    'paged'        => $paged,<br />
    'post'         => $post<br />
);<br />
$wppa_container = apply_filters( 'wppa_publication_list_container', $wppa_container );<br />
</code></p>
<h2>Loading the Template</h2>
<p>Now we actually load of the template.  Be sure to set an easy-to-remember name - I typically prefix my template files with [cci]template.[/cci] so I can remember which files in the plugin might be overridden by a theme.  A descriptive name will also help users know what the file is for:</p>
<p><code lang="php"><br />
// Get the publication list template<br />
$template_name = apply_filters( 'wppa_list_template', 'template.wppa_publication_list.php' );<br />
$path = locate_template( $template_name );<br />
if ( empty( $path ) ) {<br />
    $path = WP_PUB_ARCH_DIR . 'includes/' . $template_name;<br />
}</p>
<p>// Start a buffer to capture the HTML output of the shortcode.<br />
ob_start();</p>
<p>include( $path );</p>
<p>$output = ob_get_contents();</p>
<p>ob_end_clean();</p>
<p>// Because globals are evil, clean up afterwards.<br />
unset( $wppa_container );</p>
<p>return $output;<br />
</code></p>
<p>The idea behind this code is to check first if the theme has a similarly-named file.  If so, load that one up.  This file is placed either by the theme developer or the end user <em>specifically to work with your plugin</em>.  Make sure you respect that and defer to their markup.  If the file doesn't exist, though, load some kind of fallback from within the plugin.</p>
<p>This fallback file should serve as an example to other developers how <em>you</em> think content should appear, but it is not a strict expectation.  Consider it more of an example for how to build a shortcode template.</p>
<h3>Output Buffer</h3>
<p>Notice in this example I'm using an output buffer.  Normally, I wouldn't encourage that.  Shortcodes, thought, <em>return</em> data rather than output the data.  But template files should always be geared towards presentation.</p>
<p>It's easiest to write the template file as if it's an output file.  Use raw HTML and php's [cci]echo[/cci] to generate things.  This way it stays in-line with the widget templates we've done before and with themes (as templates) as well.</p>
<h2>Building Markup</h2>
<p>The shortcode template should have no functionality or logic.  Zero. None.</p>
<p>The template file is 100% markup.  You might throw in a loop or two to iterate through collections, but there should be no queries or other data fetching in the file.  Everything you're looping through should be provided in the global object you passed in earlier.</p>
<p>The end user might elect to add their own additional logic (third party plugins might add meta to your plugin), and they can definitely do that.  But you, as the initial developer, should not.  Keep it simple.</p>
<p><code lang="php"><br />
<?php global $wppa_container;<br />
extract( $wppa_container );<br />
?></p>
<div class="publication-archive">
<?php foreach( $publications as $publication ) { ?><br />
    <?php $pub = new WP_Publication_Archive_Item( $publication?>ID, $publication->post_title, $publication->post_date ); ?></p>
<div class="single-publication">
        <?php $pub?>the_thumbnail(); ?><br />
        <?php $pub?>the_title(); ?><br />
        <?php $pub?>the_authors(); ?><br />
        <?php $pub?>the_uri(); ?><br />
        <?php $pub?>the_summary(); ?><br />
        <?php $pub?>the_keywords(); ?><br />
        <?php $pub?>the_categories(); ?>
    </div>
<p><?php } ?>
</div>
<p></code></p>
<h2>What's Next?</h2>
<p>From here, any developer can drop a [cci]template.wppa_publication_list.php[/cci] file into their theme and replace my default markup with whatever custom markup they choose.  They can use only HTML tags ([cci]</p>
<p>&lt;</p>
<p>aside>[/cci], [cci]</p>
<p>&lt;</p>
<p>section>[/cci], and the like), they can write out XML, they can reposition elements, etc.  It's entirely up to them.</p>
<p>But the end user only ever has to enter one shortcode.  Like I said, simple.</p>
<p>Other plugin developers can also hook into the template loading process and inject some custom template as well.  Perhaps another plugin is built to specifically extend WP Publication Archive to add additional meta information and markup - they can hook in and add their own template instead.</p>

        </div>
        <footer class="post-footer">
            <div class="post-share">
                <span class="post-share-title">Share:</span>
                <a target="_blank"
                    href="https://twitter.com/share?text=Theme-ready+Shortcodes+in+WordPress&amp;url=https://ttmm.iophp/theme-ready-shortcodes-in-wordpress/">Twitter</a>
                <a target="_blank"
                    href="https://www.facebook.com/sharer/sharer.php?u=https://ttmm.iophp/theme-ready-shortcodes-in-wordpress/">Facebook</a>
            </div><!-- .share-post -->
            
            <p class="post-cats">
                <span class="post-share-title">Filed under </span>
                <a href="/categories/index.html#PHP"
                    rel="category">PHP</a>
                <a href="/categories/index.html#Tutorials"
                    rel="category">Tutorials</a>
                
            </p>
            
            
            <p class="post-tags">
                <span class="post-share-title">Tagged with </span>
                <a href="/tags/index.html#Markup"
                    rel="tag">Markup</a>
                <a href="/tags/index.html#plugin"
                    rel="tag">plugin</a>
                <a href="/tags/index.html#shortcode"
                    rel="tag">shortcode</a>
                <a href="/tags/index.html#shortcodes"
                    rel="tag">shortcodes</a>
                <a href="/tags/index.html#Templates"
                    rel="tag">Templates</a>
                <a href="/tags/index.html#WordPress"
                    rel="tag">WordPress</a>
                
            </p>
            
        </footer>
        
    </article>
    
    <section class="read-next inner">
        <h2 class="read-next-title">Read Next</h2>
        
        <article class="post">
            <header class="post-header">
                <div class="post-meta">
                    <time class="published" datetime="October 4, 2012">October 4, 2012</time>
                </div>
                <h3 class="post-title"><a href="/faith/hear-the-cry/">Hear the Cry</a>
                </h3>
            </header>
        </article>
        
        
        <article class="post">
            <header class="post-header">
                <div class="post-meta">
                    <time class="published" datetime="October 9, 2012">October 9, 2012</time>
                </div>
                <h3 class="post-title"><a href="/php/using-xml-rpc-in-wordpress/">Using XML-RPC in WordPress</a></h3>
            </header>
        </article>
        
    </section><!-- .read-next -->

</main><!-- .site-main -->


                

                
                <footer id="colophon" class="site-footer">
    <p class="site-info inner">
        <a href="#">Things that Matter Most</a> &copy; 2021. Royce theme by
        <a target="_blank" href="https://justgoodthemes.com/">JustGoodThemes</a>.
        <br />
        Powered by <a target="_blank" href="https://jekyllrb.com/">Jekyll</a>.
    </p>
    <a id="back-to-top" class="back-to-top" href="#page">
        <span class="icon-arrow-up" aria-hidden="true"></span>
        <span class="screen-reader-text">Back to top</span>
    </a>
</footer><!-- .site-footer -->
            </div><!-- .inner-wide -->
        </div><!-- .site-content -->
    </div><!-- .site -->

    
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-4156949-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-4156949-6', { 'anonymize_ip': true });
  </script>

    <!-- Javascript Assets -->
    <script src="/assets/js/jquery-3.3.1.min.js"></script>
    <script src="/assets/js/plugins.js"></script>
    <script src="/assets/js/custom.js"></script>

</body>

</html>